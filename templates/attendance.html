{% extends "index.html" %}
{% block content %}
<div class="content-card">
    <h2>Attendance</h2>

    <form id="attendance-form">
        <label for="period_id">Select Period:</label>
        <select id="period_id" name="period_id" required>
            {% for period in periods %}
            <option value="{{ period[0] }}" {% if period[0] == selected_period_id %}selected{% endif %}>
                {{ period[1] }} - {{ period[2] }} {{ period[3] }}
            </option>
            {% endfor %}
        </select>
        <button type="button" id="trigger-attendance">Trigger Attendance</button>
        <button type="button" id="view-attendance">View Attendance</button>
    </form>

    <div id="attendance-records">
        <h3 id="attendance-heading">Attendance Record</h3>
        <div id="message"></div> <!-- General message area -->
        <div id="screen-detection-message" style="color: red; font-size: 14px; margin-top: 5px;"></div> <!-- Screen detection feedback -->
        <table id="attendance-table" style="display: none; width: 100%; border-collapse: collapse; margin-top: 10px;">
            <tr style="background-color: #f2f2f2;">
                <th style="border: 1px solid #ddd; padding: 8px; text-align: left;">First Name</th>
                <th style="border: 1px solid #ddd; padding: 8px; text-align: left;">Middle Name</th>
                <th style="border: 1px solid #ddd; padding: 8px; text-align: left;">Last Name</th>
                <th style="border: 1px solid #ddd; padding: 8px; text-align: left;">Roll No</th>
                <th style="border: 1px solid #ddd; padding: 8px; text-align: left;">Status</th>
                <th style="border: 1px solid #ddd; padding: 8px; text-align: left;">Timestamp</th>
            </tr>
        </table>
    </div>

    <!-- Include jQuery and script.js -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="{{ url_for('static', filename='script.js') }}"></script>

    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            {% for category, message in messages %}
                <div class="flash-{{ category }}">{{ message }}</div>
            {% endfor %}
        {% endif %}
    {% endwith %}
</div>
{% endblock %}